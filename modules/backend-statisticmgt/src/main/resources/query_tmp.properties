SELECT 
t1.govAgencyCode[String],
sum(1) totalCount[Integer],
sum(case when t1.receiveDate >= {fromDate} AND t1.receiveDate < {toDate} then 1 else 0 end) receivedCount[Integer],
sum(case when t1.receiveDate >= {fromDate} AND t1.receiveDate < {toDate} AND t1.originality=3 then 1 else 0 end) onegateCount[Integer],
sum(case when t1.receiveDate >= {fromDate} AND t1.receiveDate < {toDate} AND t1.originality=2 then 1 else 0 end) onlineCount[Integer] ,
sum(case when t1.receiveDate < {fromDate} AND (t1.releaseDate is not null AND t1.releaseDate >= @fromDate OR t1.releaseDate is null) then 1 else 0 end) remainingCount[Integer] ,
sum(case when t1.releaseDate >= {fromDate} AND t1.releaseDate < {toDate} AND t1.releaseDate is not null AND t1.originality IN (2,3) then 1 else 0 end) releaseCount[Integer] ,
sum(case when t1.releaseDate >= {fromDate} AND t1.releaseDate < {toDate} AND t1.releaseDate is not null AND t1.originality IN (2,3) AND date_format(t1.releaseDate,'%Y-%m-%d') > date_format(t1.dueDate,'%Y-%m-%d') then 1 else 0 end) overtimeCount[Integer] ,
sum(case when t1.releaseDate >= {fromDate} AND t1.releaseDate < {toDate} AND t1.releaseDate is not null AND t1.originality in (2,3) AND date_format(t1.releaseDate,'%Y-%m-%d') < date_format(t1.dueDate,'%Y-%m-%d') then 1 else 0 end) betimesCount[Integer] ,
sum(case when t1.releaseDate >= {fromDate} AND t1.releaseDate < {toDate} AND t1.releaseDate is not null AND t1.originality in (2,3) AND date_format(t1.releaseDate,'%Y-%m-%d') = date_format(t1.dueDate,'%Y-%m-%d') then 1 else 0 end) ontimeCount[Integer] ,
sum(case when t1.releaseDate >= {fromDate} AND t1.releaseDate < {toDate} AND t1.releaseDate is not null AND t1.finishDate is not null AND t1.originality in (2,3) then 1 else 0 end) doneCount[Integer] ,
sum(case when t1.releaseDate >= {fromDate} AND t1.releaseDate < {toDate} AND t1.releaseDate is not null AND t1.finishDate is null AND t1.originality in (2,3) then 1 else 0 end) releasingCount[Integer] ,
sum(case when t1.receiveDate >= {fromDate} AND t1.receiveDate < {toDate} AND (t1.releaseDate is null OR (t1.releaseDate is not null AND t1.releaseDate > {toDate})) AND t1.originality in (2,3) then 1 else 0 end) processingCount[Integer] ,
sum(case when t1.receiveDate >= {fromDate} AND t1.receiveDate < {toDate} AND t1.dueDate > {toDate} and(t1.releaseDate is null OR (t1.releaseDate is not null AND t1.releaseDate > {toDate})) AND t1.originality in (2,3) then 1 else 0 end) undueCount[Integer] ,
sum(case when t1.receiveDate >= {fromDate} AND t1.receiveDate < {toDate} AND t1.dueDate <= {toDate} and(t1.releaseDate is null OR (t1.releaseDate is not null AND t1.releaseDate > {toDate})) AND t1.originality in (2,3) then 1 else 0 end) overdueCount[Integer] 
FROM opencps_dossier t1
INNER JOIN opencps_serviceinfo t2
ON t1.serviceCode = t2.serviceCode
WHERE t1.originality in (2,3) AND ((t1.receiveDate >= {fromDate} AND t1.receiveDate < {toDate}) OR (t1.receiveDate < {fromDate} AND (t1.releaseDate is not null AND t1.releaseDate >= {fromDate} OR t1.releaseDate is null))) GROUP BY {groupBy};